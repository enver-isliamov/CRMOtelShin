
# –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (Vercel Native)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** "–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –º–∏—Ä—ã".
–ú—ã –ø–æ—Å—Ç—Ä–æ–∏–º –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –±—ç–∫–µ–Ω–¥–∞ (Node.js + –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Postgres) –≤–Ω—É—Ç—Ä–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ Vercel. –û–Ω–∞ –±—É–¥–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ –æ—Ç —Ç–µ–∫—É—â–µ–π —Å–∏—Å—Ç–µ–º—ã (Google Sheets).

–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É "—Å—Ç–∞—Ä—ã–º" (GAS) –∏ "–Ω–æ–≤—ã–º" (Vercel) –º–∏—Ä–æ–º –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

---

## üèõ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ (Legacy) | –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (Vercel Native) |
| :--- | :--- | :--- |
| **Frontend** | React (—à–ª–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ `script.google.com`) | –¢–æ—Ç –∂–µ React (—à–ª–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ `/api/crm`) |
| **Backend** | Google Apps Script | **Vercel Serverless Functions (Node.js)** |
| **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** | Google Sheets | **Vercel Postgres (SQL)** |
| **–§–∞–π–ª—ã** | Google Drive | **Google Drive** (—á–µ—Ä–µ–∑ GAS –∞–¥–∞–ø—Ç–µ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ) |
| **Telegram –ë–æ—Ç** | GAS (`doPost` webhook) | **Vercel API (`/api/bot`)** |

---

## ‚úÖ –≠–¢–ê–ü 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–í–´–ü–û–õ–ù–ï–ù–û)

1.  [x] –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç Vercel.
2.  [x] –ü–æ–¥–∫–ª—é—á–∏—Ç—å Vercel Postgres (Storage).
3.  [x] –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`POSTGRES_URL`).

---

## ‚úÖ –≠–¢–ê–ü 2: –°–æ–∑–¥–∞–Ω–∏–µ –ù–æ–≤–æ–≥–æ –ë—ç–∫–µ–Ω–¥–∞ (–í–´–ü–û–õ–ù–ï–ù–û)

1.  [x] **`package.json`**: –î–æ–±–∞–≤–ª–µ–Ω –¥—Ä–∞–π–≤–µ—Ä `@vercel/postgres`.
2.  [x] **`api/setup.ts`**: –°–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î (–¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ `/api/setup`).
3.  [x] **`api/crm.ts`**: –û—Å–Ω–æ–≤–Ω–æ–π —à–ª—é–∑ API –Ω–∞ Node.js.

---

## ‚úÖ –≠–¢–ê–ü 3: "–†—É–±–∏–ª—å–Ω–∏–∫" –Ω–∞ –§—Ä–æ–Ω—Ç–µ–Ω–¥–µ (–í–´–ü–û–õ–ù–ï–ù–û)

1.  [x] **`services/api.ts`**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É `GAS` –∏ `VERCEL` —Ä–µ–∂–∏–º–∞–º–∏.
2.  [x] **`components/Settings.tsx`**: –î–æ–±–∞–≤–ª–µ–Ω –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

---

## ‚úÖ –≠–¢–ê–ü 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ü–µ—Ä–µ–µ–∑–¥ (–í–´–ü–û–õ–ù–ï–ù–û)

1.  [x] –î–µ–ø–ª–æ–π –Ω–∞ Vercel.
2.  [x] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î —á–µ—Ä–µ–∑ `/api/setup`.
3.  [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ ID).
4.  [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –ë–î.

---

## ‚úÖ –≠–¢–ê–ü 5: –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–í–´–ü–û–õ–ù–ï–ù–û)

1.  [x] –ü–µ—Ä–µ–Ω–æ—Å –∫–ª–∏–µ–Ω—Ç–æ–≤, –∞—Ä—Ö–∏–≤–∞ –∏ –º–∞—Å—Ç–µ—Ä–æ–≤ –∏–∑ Google Sheets –≤ Postgres —á–µ—Ä–µ–∑ UI CRM.

---

## ü§ñ –≠–¢–ê–ü 6: –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–µ–∑–¥ –ë–æ—Ç–∞ (Vercel Native)

### 6.1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–í–´–ü–û–õ–ù–ï–ù–û)
1.  [x] **–û–±–Ω–æ–≤–∏—Ç—å `api/setup.ts`**: –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ `bot_sessions`.

### 6.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è Vercel (–í–´–ü–û–õ–ù–ï–ù–û)
1.  [x] –î–æ–±–∞–≤–∏—Ç—å `TELEGRAM_BOT_TOKEN`.
2.  [x] –î–æ–±–∞–≤–∏—Ç—å `ADMIN_CHAT_ID`.

### 6.3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API CRM (–í–´–ü–û–õ–ù–ï–ù–û)
1.  [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `crmSendMessage` –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π `sendMessage`/`bulksend` –≤ `api/crm.ts`.

### 6.4. –°–æ–∑–¥–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ –ë–æ—Ç–∞ (–í–´–ü–û–õ–ù–ï–ù–û)
1.  [x] **`api/bot.ts`**: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω Webhook-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ Node.js.
2.  [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SQL (`clients`, `bot_sessions`).
3.  [x] –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ–Ω—é: –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é, –õ–ö, –ó–∞–ø–∏—Å—å, –ü—Ä–æ–¥–ª–µ–Ω–∏–µ.

### 6.5. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ Webhook (–í–´–ü–û–õ–ù–ï–ù–û)
1.  [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ü—Ä–∏–≤—è–∑–∞—Ç—å –±–æ—Ç–∞ –∫ Vercel" –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö CRM. 
2.  [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ `setWebhook` —á–µ—Ä–µ–∑ Vercel-–±—ç–∫–µ–Ω–¥.

### 6.6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1.  [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `/start`.
2.  [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å "–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç" (–¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞ –≤ Postgres).
3.  [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–∑ CRM.
